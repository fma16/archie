!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).littlefoot={})}(this,function(e){"use strict";function t(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports}function n(e,t){e.classList.add(t)}function r(e,t){e.classList.remove(t)}function o(e){var t;null!==(t=e.parentNode)&&void 0!==t&&t.removeChild(e)}function i(e){var t=e.offsetHeight,n=e.getBoundingClientRect().top+t/2;return{top:n,bottom:window.innerHeight-n}}function a(e){var t=parseFloat(O.getStyle(e,"marginLeft")),n=e.offsetWidth-t;return(e.getBoundingClientRect().left+n/2)/window.innerWidth}function u(e,t){var n=2*parseInt(O.getStyle(e,"marginTop"),10)+e.offsetHeight;return t.bottom<n&&t.bottom<t.top?"top":"bottom"}function c(e){var t=e.id,c=e.button,s=e.content,l=e.host,f=e.popover,d=e.wrapper,p=!1,h=0;return{id:t,activate:function(e){var t;c.setAttribute("aria-expanded","true"),n(c,M),n(c,A),c.insertAdjacentElement("afterend",f),f.style.maxWidth=document.body.clientWidth+"px",t=s,h=Math.round(P.pixels(O.getStyle(t,"maxHeight"),t)),null!=e&&e(f,c)},dismiss:function(e){c.setAttribute("aria-expanded","false"),n(c,M),r(c,A),r(f,A),null!=e&&e(f,c)},isActive:function(){return c.classList.contains(A)},isReady:function(){return!c.classList.contains(M)},isHovered:function(){return p},ready:function(){n(f,A),r(c,M)},remove:function(){o(f),r(c,M)},reposition:function(){var e,t,o,l,d,p,v,m,y,g,b;H(f)&&(s.style.maxHeight=(v=f,m=h,y=i(c),g=u(v,y),b=parseInt(O.getStyle(v,"marginTop"),10),Math.min(m,y[g]-b-15)+"px"),d=u(e=f,i(t=c)),(p=e.dataset.footnotePosition)!==d&&(e.dataset.footnotePosition=d,r(e,""+T+p),n(e,""+T+d),o=100*a(t)+"%",l="top"===d?"100%":"0",e.style.transformOrigin=o+" "+l),f.offsetHeight<s.scrollHeight?(n(f,D),s.setAttribute("tabindex","0")):(r(f,D),s.removeAttribute("tabindex")))},resize:function(){var e,t,n,r;H(f)&&(f.style.left=(n=c,r=s.offsetWidth,-a(n)*r+parseInt(O.getStyle(n,"marginLeft"),10)+n.offsetWidth/2+"px"),d.style.maxWidth=s.offsetWidth+"px",e=c,(t=f.querySelector("."+j))&&(t.style.left=100*a(e)+"%"))},startHovering:function(){p=!0},stopHovering:function(){p=!1},destroy:function(){return o(l)}}}function s(e,t){return Array.from(e.querySelectorAll(t))}function l(e,t){return e.querySelector("."+t)||e.firstElementChild||e}function f(e){var t=document.createElement("div");return t.innerHTML=e,t.firstElementChild}function d(e){return void 0!==e}function p(e){var t,n,r=(t=e,n=":not(."+R+")",Array.from(t.children).filter(function(e){return 8!==e.nodeType&&(!n||e.matches(n))})),o=r.filter(function(e){return"HR"===e.tagName});r.length===o.length&&(o.concat(e).forEach(q),p(e.parentElement))}function h(e){var t=e.parentElement;o(e);var n=null==t?void 0:t.innerHTML.replace("[]","").replace("&nbsp;"," ").trim();t&&!n&&h(t)}function v(e,t){var n=f(e.body.outerHTML);s(n,'[href$="#'+e.referenceId+'"]').forEach(h);var r=n.innerHTML.trim();return{original:e,data:{id:""+(t+1),number:t+1,reference:"lf-"+e.referenceId,content:r.startsWith("<")?r:"<p>"+r+"</p>"}}}function m(e){var t=/<%=?\s*(\w+?)\s*%>/g;return function(n){return e.replace(t,function(e,t){var r;return String(null!==(r=n[t])&&void 0!==r?r:"")})}}function y(e,t){var n=m(e),r=m(t);return function(e){var t=e.original,o=e.data,i=o.id,a=f('<span class="'+z+'">'+n(o)+"</span>"),u=a.firstElementChild;u.dataset.footnoteButton="",u.dataset.footnoteId=i,u.dataset.footnoteNumber=""+o.number;var c=f(r(o));c.dataset.footnotePopover="",c.dataset.footnoteId=i;var s,d=l(c,C),p=l(c,W);return s=c,p.addEventListener("wheel",k.throttle(F(s),I)),{original:t,data:o,id:i,button:u,host:a,popover:c,content:p,wrapper:d}}}function g(e){var t,n,o,i,a,u,l,f=e.allowDuplicates,h=e.anchorParentSelector,m=e.anchorPattern,g=e.buttonTemplate,b=e.contentTemplate,w=e.footnoteSelector,_=e.numberResetSelector,x=e.scope,S=(u=document,l=m,s(u,x+' a[href*="#"]').filter(function(e){return(e.href+e.rel).match(l)}).map((t=document,n=f,o=h,i=w,a=[],function(e){var r="#"+e.href.split("#")[1].replace(/[:.+~*[\]]/g,"\\$&"),u=s(t,r).find(function(e){return n||!a.includes(e)}),c=null==u?void 0:u.closest(i);if(c){a.push(c);var l=e.closest(o)||e;return{reference:l,referenceId:l.id||e.id,body:c}}})).filter(d).map(v).map(_?U(_):function(e){return e}).map(y(g,b)));S.forEach(function(e){var t,n,r=e.original,o=e.host;q(r.reference),q(r.body),p(r.body.parentElement),t=r.reference,n=o,t.insertAdjacentElement("beforebegin",n)});var E=S.map(c);return{footnotes:E,unmount:function(){E.forEach(function(e){return e.destroy()}),s(document,"."+R).forEach(function(e){return r(e,R)})}}}function b(e,t){function n(e){return function(n){n.isReady()&&(n.dismiss(t.dismissCallback),setTimeout(n.remove,e))}}function r(e){return function(r){t.allowMultiple||i.filter(function(e){return e.id!==r.id}).forEach(n(t.dismissDelay)),r.isReady()&&(r.activate(t.activateCallback),r.reposition(),r.resize(),setTimeout(r.ready,e))}}function o(e){return function(t){var n=i.find(function(e){return e.id===t});n&&e(n)}}var i=e.footnotes,a=e.unmount;return{activate:function(e,t){return o(r(t))(e)},dismiss:function(e,t){return o(n(t))(e)},dismissAll:function(){return i.forEach(n(t.dismissDelay))},repositionAll:function(){return i.forEach(function(e){return e.reposition()})},resizeAll:function(){return i.forEach(function(e){return e.resize()})},toggle:o(function(e){return(e.isActive()?n(t.dismissDelay):r(t.activateDelay))(e)}),hover:o(function(e){e.startHovering(),t.activateOnHover&&!e.isActive()&&r(t.hoverDelay)(e)}),unhover:o(function(e){e.stopHovering(),t.dismissOnUnhover&&setTimeout(function(){return i.filter(function(e){return!e.isHovered()}).forEach(n(t.dismissDelay))},t.hoverDelay)}),unmount:a}}function w(e,t){return e.target.closest(t)}function _(e){return null==e?void 0:e.dataset.footnoteId}function x(e){void 0===e&&(e={});var t,n,r,o,i,a,u,c=E.__assign(E.__assign({},V),e),s=b(g(c),c),l=(n=Y((t=s).toggle,t.dismissAll),r=K(t.dismissAll),o=k.throttle(t.repositionAll,G),i=k.throttle(t.resizeAll,G),a=J(t.hover),u=J(t.unhover),Q("touchend",n),Q("click",n),Q("keyup",r),Q("gestureend",o),Z("scroll",o),Z("resize",i),B.on("mouseover",$,a),B.on("mouseout",$,u),function(){X("touchend",n),X("click",n),X("keyup",r),X("gestureend",o),ee("scroll",o),ee("resize",i),B.off("mouseover",$,a),B.off("mouseout",$,u)});return{activate:function(e,t){void 0===t&&(t=c.activateDelay),s.activate(e,t)},dismiss:function(e,t){void 0===t&&(t=c.dismissDelay),void 0===e?s.dismissAll():s.dismiss(e,t)},unmount:function(){l(),s.unmount()},getSetting:function(e){return c[e]},updateSetting:function(e,t){c[e]=t}}}var S="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},E=t(function(e){var t,n,r,o,i,a,u,c,s,l,f,d,p,h,v,m,y,g,b,w,_,x,E;!function(){function O(e,t){return e!==T&&("function"==typeof Object.create?Object.defineProperty(e,"__esModule",{value:!0}):e.__esModule=!0),function(n,r){return e[n]=t?t(n,r):r}}var P,j,T="object"==typeof S?S:"object"==typeof self?self:"object"==typeof this?this:{};P=O(T,O(e.exports)),j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},t=function(e,t){function n(){this.constructor=e}j(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r=function(e,t){var n={};for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]]);return n},o=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;0<=u;u--)(o=e[u])&&(a=(i<3?o(a):3<i?o(t,n,a):o(t,n))||a);return 3<i&&a&&Object.defineProperty(t,n,a),a},i=function(e,t){return function(n,r){t(n,r,e)}},a=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},u=function(e,t,n,r){return new(n=n||Promise)(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(a,u)}c((r=r.apply(e,t||[])).next())})},c=function(e,t){function n(n){return function(u){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(i=2&n[0]?o.return:n[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,n[1])).done)return i;switch(o=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,o=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(i=0<(i=a.trys).length&&i[i.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){a.label=n[1];break}if(6===n[0]&&a.label<i[1]){a.label=i[1],i=n;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(n);break}i[2]&&a.ops.pop(),a.trys.pop();continue}n=t.call(e,a)}catch(e){n=[6,e],o=0}finally{r=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,u])}}var r,o,i,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},u={next:n(0),throw:n(1),return:n(2)};return"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u},E=function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]},s=function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||(t[n]=e[n])},l=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},f=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},d=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(f(arguments[t]));return e},p=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},h=function(e){return this instanceof h?(this.v=e,this):new h(e)},v=function(e,t,n){function r(e){c[e]&&(l[e]=function(t){return new Promise(function(n,r){1<s.push([e,t,n,r])||o(e,t)})})}function o(e,t){try{(n=c[e](t)).value instanceof h?Promise.resolve(n.value.v).then(i,a):u(s[0][2],n)}catch(e){u(s[0][3],e)}var n}function i(e){o("next",e)}function a(e){o("throw",e)}function u(e,t){e(t),s.shift(),s.length&&o(s[0][0],s[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var c=n.apply(e,t||[]),s=[],l={};return r("next"),r("throw"),r("return"),l[Symbol.asyncIterator]=function(){return this},l},m=function(e){function t(t,o){r[t]=e[t]?function(r){return(n=!n)?{value:h(e[t](r)),done:"return"===t}:o?o(r):r}:o}var n,r={};return t("next"),t("throw",function(e){throw e}),t("return"),r[Symbol.iterator]=function(){return this},r},y=function(e){function t(t){n[t]=e[t]&&function(n){return new Promise(function(r,o){var i,a,u,c;n=e[t](n),i=r,a=o,u=n.done,c=n.value,Promise.resolve(c).then(function(e){i({value:e,done:u})},a)})}}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,r=e[Symbol.asyncIterator];return r?r.call(e):(e=l(e),n={},t("next"),t("throw"),t("return"),n[Symbol.asyncIterator]=function(){return this},n)},g=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},b=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},w=function(e){return e&&e.__esModule?e:{default:e}},_=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},x=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n},P("__extends",t),P("__assign",n),P("__rest",r),P("__decorate",o),P("__param",i),P("__metadata",a),P("__awaiter",u),P("__generator",c),P("__exportStar",s),P("__createBinding",E),P("__values",l),P("__read",f),P("__spread",d),P("__spreadArrays",p),P("__await",h),P("__asyncGenerator",v),P("__asyncDelegator",m),P("__asyncValues",y),P("__makeTemplateObject",g),P("__importStar",b),P("__importDefault",w),P("__classPrivateFieldGet",_),P("__classPrivateFieldSet",x)}()}),O=t(function(e,t){t.__esModule=!0,t.getStyle=void 0,t.getStyle=function(e,t){var n,r=((null===(n=e.ownerDocument)||void 0===n?void 0:n.defaultView)||window).getComputedStyle(e);return r.getPropertyValue(t)||r[t]}}),P=t(function(e,t){function n(e){return e?O.getStyle(e,"fontSize")||n(e.parentElement):O.getStyle(window.document.documentElement,"fontSize")}t.__esModule=!0,t.pixels=void 0;var r=96,o=25.4,i=72,a=6;t.pixels=function e(t,u){var c,s,l,f,d,p,h=null!==(s=null===(c=null==u?void 0:u.ownerDocument)||void 0===c?void 0:c.defaultView)&&void 0!==s?s:window,v=h.document.documentElement||h.document.body,m=(f=t||"0",d=parseFloat(f),p=f.match(/[\d-.]+(\w+)$/),[d,(null!==(l=null==p?void 0:p[1])&&void 0!==l?l:"").toLowerCase()]),y=m[0];switch(m[1]){case"rem":return y*e(n(window.document.documentElement));case"em":return y*e(n(u),null==u?void 0:u.parentElement);case"in":return y*r;case"q":return y*r/o/4;case"mm":return y*r/o;case"cm":return y*r*10/o;case"pt":return y*r/i;case"pc":return y*r/a;case"vh":return(y*h.innerHeight||v.clientWidth)/100;case"vw":return(y*h.innerWidth||v.clientHeight)/100;case"vmin":return y*Math.min(h.innerWidth||v.clientWidth,h.innerHeight||v.clientHeight)/100;case"vmax":return y*Math.max(h.innerWidth||v.clientWidth,h.innerHeight||v.clientHeight)/100;default:return y}}}),j="littlefoot-footnote__tooltip",T="is-positioned-",A="is-active",M="is-changing",D="is-scrollable",H=function(e){return!!e.parentElement},k=t(function(e,t){t.__esModule=!0,t.throttle=void 0,t.throttle=function(e,t){void 0===t&&(t=0);var n,r=0;return Object.assign(function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];var a=Math.max(0,r+t-Date.now());a?(clearTimeout(n),n=setTimeout(function(){r=Date.now(),e.apply(void 0,o)},a)):(r=Date.now(),e.apply(void 0,o))},{cancel:function(){r=0,clearTimeout(n)}})}}),I=16,L="is-fully-scrolled",F=function(e){return function(t){var o=t.currentTarget,i=-t.deltaY;0<i&&r(e,L),o&&i<=0&&i<o.clientHeight+o.scrollTop-o.scrollHeight&&n(e,L)}},W="littlefoot-footnote__content",C="littlefoot-footnote__wrapper",R="footnote-print-only",z="littlefoot-footnote__host",q=function(e){return n(e,R)},U=function(e){var t=0,n=null;return function(r){var o=r.original,i=r.data,a=o.reference.closest(e);return t=n===a?t+1:1,n=a,{original:o,data:E.__assign(E.__assign({},i),{number:t})}}},V={activateDelay:100,activateOnHover:!1,allowDuplicates:!0,allowMultiple:!1,anchorParentSelector:"sup",anchorPattern:/(fn|footnote|note)[:\-_\d]/gi,dismissDelay:100,dismissOnUnhover:!1,footnoteSelector:"li",hoverDelay:250,numberResetSelector:"",scope:"",contentTemplate:'<aside class="littlefoot-footnote" id="fncontent:<% id %>"><div class="'+C+'"><div class="'+W+'"><% content %></div></div><div class="'+j+'"></div></aside>',buttonTemplate:'<button aria-expanded="false" aria-label="Footnote <% number %>" class="littlefoot-footnote__button" id="<% reference %>" title="See Footnote <% number %>" /> <% number %> </button>'},N=t(function(e,t){e.exports=function(){function e(){if(!(this instanceof e))return new e;this.size=0,this.uid=0,this.selectors=[],this.selectorObjects={},this.indexes=Object.create(this.indexes),this.activeIndexes=[]}function t(e,t){e=e.slice(0).concat(e.default);var n,r,o,i,a,u,c=e.length,l=t,f=[];do{if(s.exec(""),(o=s.exec(l))&&(l=o[3],o[2]||!l))for(n=0;n<c;n++)if(u=e[n],a=u.selector(o[1])){for(r=f.length,i=!1;r--;)if(f[r].index===u&&f[r].key===a){i=!0;break}i||f.push({index:u,key:a});break}}while(o);return f}function n(e,t){return e.id-t.id}var r=window.document.documentElement,o=r.matches||r.webkitMatchesSelector||r.mozMatchesSelector||r.oMatchesSelector||r.msMatchesSelector;e.prototype.matchesSelector=function(e,t){return o.call(e,t)},e.prototype.querySelectorAll=function(e,t){return t.querySelectorAll(e)};var i=/^#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/g;(e.prototype.indexes=[]).push({name:"ID",selector:function(e){var t;if(t=e.match(i))return t[0].slice(1)},element:function(e){if(e.id)return[e.id]}});var a=/^\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/g;e.prototype.indexes.push({name:"CLASS",selector:function(e){var t;if(t=e.match(a))return t[0].slice(1)},element:function(e){var t=e.className;if(t){if("string"==typeof t)return t.split(/\s/);if("object"==typeof t&&"baseVal"in t)return t.baseVal.split(/\s/)}}});var u,c=/^((?:[\w\u00c0-\uFFFF\-]|\\.)+)/g;e.prototype.indexes.push({name:"TAG",selector:function(e){var t;if(t=e.match(c))return t[0].toUpperCase()},element:function(e){return[e.nodeName.toUpperCase()]}}),e.prototype.indexes.default={name:"UNIVERSAL",selector:function(){return!0},element:function(){return[!0]}},u="function"==typeof window.Map?window.Map:function(){function e(){this.map={}}return e.prototype.get=function(e){return this.map[e+" "]},e.prototype.set=function(e,t){this.map[e+" "]=t},e}();var s=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g;return e.prototype.logDefaultIndexUsed=function(){},e.prototype.add=function(e,n){var r,o,i,a,c,s,l,f,d=this.activeIndexes,p=this.selectors,h=this.selectorObjects;if("string"==typeof e){for(h[(r={id:this.uid++,selector:e,data:n}).id]=r,l=t(this.indexes,e),o=0;o<l.length;o++)a=(f=l[o]).key,(c=function(e,t){var n,r,o;for(n=0,r=e.length;n<r;n++)if(o=e[n],t.isPrototypeOf(o))return o}(d,i=f.index))||((c=Object.create(i)).map=new u,d.push(c)),i===this.indexes.default&&this.logDefaultIndexUsed(r),(s=c.map.get(a))||(s=[],c.map.set(a,s)),s.push(r);this.size++,p.push(e)}},e.prototype.remove=function(e,n){if("string"==typeof e){for(var r,o,i,a,u,c,s=this.activeIndexes,l=this.selectors=[],f=this.selectorObjects,d={},p=1===arguments.length,h=t(this.indexes,e),v=0;v<h.length;v++)for(r=h[v],o=s.length;o--;)if(a=s[o],r.index.isPrototypeOf(a)){if(u=a.map.get(r.key))for(i=u.length;i--;)(c=u[i]).selector!==e||!p&&c.data!==n||(u.splice(i,1),d[c.id]=!0);break}for(v in d)delete f[v],this.size--;for(v in f)l.push(f[v].selector)}},e.prototype.queryAll=function(e){if(!this.selectors.length)return[];for(var t,r,o,i,a,u,c={},s=[],l=this.querySelectorAll(this.selectors.join(", "),e),f=0,d=l.length;f<d;f++)for(o=l[f],t=0,r=(i=this.matches(o)).length;t<r;t++)c[(u=i[t]).id]?a=c[u.id]:(a={id:u.id,selector:u.selector,data:u.data,elements:[]},c[u.id]=a,s.push(a)),a.elements.push(o);return s.sort(n)},e.prototype.matches=function(e){if(!e)return[];for(var t,r,o,i,a,u,c,s,l,f=this.activeIndexes,d={},p=[],h=0,v=f.length;h<v;h++)if(u=(a=f[h]).element(e))for(t=0,o=u.length;t<o;t++)if(c=a.map.get(u[t]))for(r=0,i=c.length;r<i;r++)!d[l=(s=c[r]).id]&&this.matchesSelector(e,s.selector)&&(d[l]=!0,p.push(s));return p.sort(n)},e}()}),B=t(function(e,t){!function(e,t){function n(e,t,n){var r=e[t];return e[t]=function(){return n.apply(e,arguments),r.apply(e,arguments)},e}function r(e,t,n){var r=[],o=t;do{if(1!==o.nodeType)break;var i=e.matches(o);if(i.length){var a={node:o,observers:i};n?r.unshift(a):r.push(a)}}while(o=o.parentElement);return r}function o(){v.set(this,!0)}function i(){v.set(this,!0),m.set(this,!0)}function a(){return y.get(this)||null}function u(e,t){g&&Object.defineProperty(e,"currentTarget",{configurable:!0,enumerable:!0,get:t||g.get})}function c(e){try{return e.eventPhase,!0}catch(e){return!1}}function s(e){if(c(e)){var t=1===e.eventPhase?h:p,s=t[e.type];if(s){var l=r(s,e.target,1===e.eventPhase);if(l.length){n(e,"stopPropagation",o),n(e,"stopImmediatePropagation",i),u(e,a);for(var f=0,d=l.length;f<d&&!v.get(e);f++){var g=l[f];y.set(e,g.node);for(var b=0,w=g.observers.length;b<w&&!m.get(e);b++)g.observers[b].data.call(g.node,e)}y.delete(e),u(e)}}}}function l(e,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=!!o.capture,a=i?h:p,u=a[e];u||(u=new t,a[e]=u,document.addEventListener(e,s,i)),u.add(n,r)}function f(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=!!r.capture,i=o?h:p,a=i[e];a&&(a.remove(t,n),a.size||(delete i[e],document.removeEventListener(e,s,o)))}function d(e,t,n){return e.dispatchEvent(new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n}))}t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t;var p={},h={},v=new WeakMap,m=new WeakMap,y=new WeakMap,g=Object.getOwnPropertyDescriptor(Event.prototype,"currentTarget");e.fire=d,e.off=f,e.on=l,Object.defineProperty(e,"__esModule",{value:!0})}(t,N)}),G=16,$="[data-footnote-id]",Y=function(e,t){return function(n){var r=w(n,"[data-footnote-button]"),o=_(r);o?e(o):w(n,"[data-footnote-popover]")||t()}},J=function(e){return function(t){t.preventDefault();var n=w(t,$),r=_(n);r&&e(r)}},K=function(e){return function(t){27!==t.keyCode&&"Escape"!==t.key&&"Esc"!==t.key||e()}},Q=document.addEventListener,X=document.removeEventListener,Z=window.addEventListener,ee=window.removeEventListener;e.default=x,e.littlefoot=x,Object.defineProperty(e,"__esModule",{value:!0})});